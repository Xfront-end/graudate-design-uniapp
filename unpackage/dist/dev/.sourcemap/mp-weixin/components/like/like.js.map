{"version":3,"sources":["webpack:///C:/Users/zht/Documents/HBuilderProjects/schoolService/components/like/like.vue?87f7","webpack:///C:/Users/zht/Documents/HBuilderProjects/schoolService/components/like/like.vue?9c33","webpack:///C:/Users/zht/Documents/HBuilderProjects/schoolService/components/like/like.vue?e4f1","webpack:///C:/Users/zht/Documents/HBuilderProjects/schoolService/components/like/like.vue?84ea","webpack:///C:/Users/zht/Documents/HBuilderProjects/schoolService/components/like/like.vue","webpack:///C:/Users/zht/Documents/HBuilderProjects/schoolService/components/like/like.vue?f4fa","webpack:///C:/Users/zht/Documents/HBuilderProjects/schoolService/components/like/like.vue?52c7"],"names":["db","wx","cloud","database","newThings","collection","zan","comment","props","docid","type","String","currentDB","default","data","isLike","favNum","openid","favNumInThisDB","methods","toggleLike","add","createdTime","serverDate","then","res","updataFavNum","callFunction","name","$url","getUserOpenid","Promise","resolve","reject","result","catch","err","initIsLike","where","_openid","get","length","num","initFavNum","doc","console","log","created"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6H;AAC7H;AACwD;AACL;AACqC;;;AAGxF;AAC8M;AAC9M,gBAAgB,qNAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,+FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAwzB,CAAgB,szBAAG,EAAC,C;;;;;;;;;;;;25BCA50B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAMA,EAAE,GAAGC,EAAE,CAACC,KAAH,CAASC,QAAT,EAAX;AACA,IAAMC,SAAS,GAAGJ,EAAE,CAACK,UAAH,CAAc,WAAd,CAAlB;AACA,IAAMC,GAAG,GAAGN,EAAE,CAACK,UAAH,CAAc,KAAd,CAAZ;AACA,IAAME,OAAO,GAAGP,EAAE,CAACK,UAAH,CAAc,kBAAd,CAAhB,C;AACe;AACdG,OAAK,EAAE;AACNC,SAAK,EAAE;AACNC,UAAI,EAAEC,MADA,EADD;;AAINC,aAAS,EAAE;AACVF,UAAI,EAAEC,MADI;AAEVE,aAFU,sBAEA;AACT,eAAO,WAAP;AACA,OAJS,EAJL,EADO;;;AAYdC,MAZc,kBAYP;AACN,WAAO;AACNC,YAAM,EAAE,KADF;AAENC,YAAM,EAAE,CAFF;AAGNC,YAAM,EAAE,EAHF;AAINC,oBAAc,EAAE,KAAKN,SAJf,EAAP;;AAMA,GAnBa;AAoBdO,SAAO,EAAE;AACRC,cADQ,wBACK;AACZ,WAAKL,MAAL,GAAc,CAAC,KAAKA,MAApB;AACA,UAAI,KAAKA,MAAT,EAAiB;AAChB,aAAKC,MAAL;AACAV,WAAG,CAACe,GAAJ,CAAQ;AACPP,cAAI,EAAE;AACLL,iBAAK,EAAE,KAAKA,KADP;AAELa,uBAAW,EAAEtB,EAAE,CAACuB,UAAH,EAFR,EADC,EAAR;;AAKGC,YALH,CAKQ,UAAAC,GAAG,EAAI;AACd,eAAI,CAACC,YAAL,CAAkB,CAAlB;AACA,SAPD;AAQA,OAVD,MAUO;AACN,aAAKV,MAAL;AACAf,UAAE,CAACC,KAAH,CAASyB,YAAT,CAAsB;AACrBC,cAAI,EAAE,YADe;AAErBd,cAAI,EAAE;AACLe,gBAAI,EAAE,YADD;AAELZ,kBAAM,EAAE,KAAKA,MAFR;AAGLR,iBAAK,EAAE,KAAKA,KAHP,EAFe,EAAtB;;AAOGe,YAPH,CAOQ,UAAAC,GAAG,EAAI;AACd,eAAI,CAACC,YAAL,CAAkB,CAAC,CAAnB;AACA,SATD;AAUA;AACD,KA1BO;AA2BRI,iBA3BQ,2BA2BQ;AACf,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACvChC,UAAE,CAACC,KAAH,CAASyB,YAAT,CAAsB;AACrBC,cAAI,EAAE,OADe,EAAtB;AAEGJ,YAFH,CAEQ,UAAAC,GAAG,EAAI;AACd,gBAAI,CAACR,MAAL,GAAcQ,GAAG,CAACS,MAAJ,CAAWjB,MAAzB;AACAe,iBAAO;AACP,SALD,EAKGG,KALH,CAKS,UAAAC,GAAG,EAAI;AACfH,gBAAM,CAACG,GAAD,CAAN;AACA,SAPD;AAQA,OATM,CAAP;AAUA,KAtCO;AAuCRC,cAvCQ,sBAuCGpB,MAvCH,EAuCWR,KAvCX,EAuCkB;AACzB,aAAO,IAAIsB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACvC3B,WAAG,CAACgC,KAAJ,CAAU;AACRC,iBAAO,EAAEtB,MADD;AAERR,eAAK,EAAEA,KAFC,EAAV;AAGI+B,WAHJ;AAIEhB,YAJF,CAIO,UAAAC,GAAG,EAAI;AACZ,gBAAI,CAACV,MAAL,GAAcU,GAAG,CAACX,IAAJ,CAAS2B,MAAT,KAAoB,CAApB,GAAwB,KAAxB,GAAgC,IAA9C;AACAT,iBAAO;AACP,SAPF;AAQA,OATM,CAAP;AAUA,KAlDO;AAmDRN,gBAnDQ,wBAmDKgB,GAnDL,EAmDU;AACjBzC,QAAE,CAACC,KAAH,CAASyB,YAAT,CAAsB;AACrBC,YAAI,EAAE,YADe;AAErBd,YAAI,EAAE;AACLL,eAAK,EAAE,KAAKA,KADP;AAELiC,aAAG,EAAHA,GAFK;AAGL9B,mBAAS,EAAE,KAAKM,cAHX;AAILW,cAAI,EAAE,cAJD,EAFe,EAAtB;;;AASA,KA7DO;AA8DRc,cA9DQ,wBA8DK;AACZ,UAAI/B,SAAS,GAAG,IAAhB;AACA,UAAG,KAAKM,cAAL,KAAwB,WAA3B,EAAwC;AACvCN,iBAAS,GAAGR,SAAZ;AACA,OAFD,MAEM,IAAG,KAAKc,cAAL,KAAwB,SAA3B,EAAsC;AAC3CN,iBAAS,GAAGL,OAAZ;AACA;AACDK,eAAS,CAACgC,GAAV,CAAc,KAAKnC,KAAnB,EAA0B+B,GAA1B,GAAgChB,IAAhC,CAAqC,UAAAC,GAAG,EAAI;AAC3C,cAAI,CAACT,MAAL,GAAcS,GAAG,CAACX,IAAJ,CAASE,MAAvB;AACA,OAFD,EAEGmB,KAFH,CAES,UAAAC,GAAG,EAAI;AACfS,eAAO,CAACC,GAAR;AACA,OAJD;AAKA,KA1EO,EApBK;;AAgGRC,SAhGQ;AAiGP,qBAAKjB,aAAL,EAjGO;AAkGP,qBAAKO,UAAL,CAAgB,KAAKpB,MAArB,EAA6B,KAAKR,KAAlC,CAlGO;AAmGb,mBAAKkC,UAAL,GAnGa,iJ;;;;;;;;;;;;ACff;AAAA;AAAA;AAAA;AAAyrC,CAAgB,mpCAAG,EAAC,C;;;;;;;;;;;ACA7sC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/like/like.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./like.vue?vue&type=template&id=16ed3171&scoped=true&\"\nvar renderjs\nimport script from \"./like.vue?vue&type=script&lang=js&\"\nexport * from \"./like.vue?vue&type=script&lang=js&\"\nimport style0 from \"./like.vue?vue&type=style&index=0&id=16ed3171&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"16ed3171\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"Documents/HBuilderProjects/schoolService/components/like/like.vue\"\nexport default component.exports","export * from \"-!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./like.vue?vue&type=template&id=16ed3171&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./like.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./like.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nconst db = wx.cloud.database()\nconst newThings = db.collection('newThings')\nconst zan = db.collection('zan')\nconst comment = db.collection('newThingsComment')\nexport default {\n\tprops: {\n\t\tdocid: {\n\t\t\ttype: String\n\t\t},\n\t\tcurrentDB: {\n\t\t\ttype: String,\n\t\t\tdefault() {\n\t\t\t\treturn 'newThings'\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisLike: false,\n\t\t\tfavNum: 0,\n\t\t\topenid: '',\n\t\t\tfavNumInThisDB: this.currentDB\n\t\t}\n\t},\n\tmethods: {\n\t\ttoggleLike() {\n\t\t\tthis.isLike = !this.isLike\n\t\t\tif (this.isLike) {\n\t\t\t\tthis.favNum++\n\t\t\t\tzan.add({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdocid: this.docid,\n\t\t\t\t\t\tcreatedTime: db.serverDate()\n\t\t\t\t\t}\n\t\t\t\t}).then(res => {\n\t\t\t\t\tthis.updataFavNum(1)\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tthis.favNum--\n\t\t\t\twx.cloud.callFunction({\n\t\t\t\t\tname: 'controlzan',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t$url: 'deletelike',\n\t\t\t\t\t\topenid: this.openid,\n\t\t\t\t\t\tdocid: this.docid\n\t\t\t\t\t}\n\t\t\t\t}).then(res => {\n\t\t\t\t\tthis.updataFavNum(-1)\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tgetUserOpenid() {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\twx.cloud.callFunction({\n\t\t\t\t\tname: 'login'\n\t\t\t\t}).then(res => {\n\t\t\t\t\tthis.openid = res.result.openid\n\t\t\t\t\tresolve()\n\t\t\t\t}).catch(err => {\n\t\t\t\t\treject(err)\n\t\t\t\t})\n\t\t\t})\n\t\t},\n\t\tinitIsLike(openid, docid) {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tzan.where({\n\t\t\t\t\t\t_openid: openid,\n\t\t\t\t\t\tdocid: docid\n\t\t\t\t\t}).get()\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tthis.isLike = res.data.length === 0 ? false : true\n\t\t\t\t\t\tresolve()\n\t\t\t\t\t})\n\t\t\t})\n\t\t},\n\t\tupdataFavNum(num) {\n\t\t\twx.cloud.callFunction({\n\t\t\t\tname: 'controlzan',\n\t\t\t\tdata: {\n\t\t\t\t\tdocid: this.docid,\n\t\t\t\t\tnum,\n\t\t\t\t\tcurrentDB: this.favNumInThisDB,\n\t\t\t\t\t$url: 'updataFavNum'\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tinitFavNum() {\n\t\t\tlet currentDB = null\n\t\t\tif(this.favNumInThisDB === 'newThings') {\n\t\t\t\tcurrentDB = newThings\n\t\t\t}else if(this.favNumInThisDB === 'comment') {\n\t\t\t\tcurrentDB = comment\n\t\t\t}\n\t\t\tcurrentDB.doc(this.docid).get().then(res => {\n\t\t\t\tthis.favNum = res.data.favNum\n\t\t\t}).catch(err => {\n\t\t\t\tconsole.log()\n\t\t\t})\n\t\t}\n\t},\n\tasync created() {\n\t\tawait this.getUserOpenid()\n\t\tawait this.initIsLike(this.openid, this.docid)\n\t\tthis.initFavNum()\n\t}\n}\n","import mod from \"-!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-2!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./like.vue?vue&type=style&index=0&id=16ed3171&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-2!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./like.vue?vue&type=style&index=0&id=16ed3171&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1586339396211\n      var cssReload = require(\"C:/Users/zht/Downloads/HBuilderX.2.5.1.20200103.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}